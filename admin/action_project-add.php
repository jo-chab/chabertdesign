<?php	include("../_includes/session_test.inc");	include("../_includes/chabertdesign.inc");    include("../_includes/_fileUpload.inc"); // Include the file with the handleFileUpload function    require_once '../vendor/ezyang/htmlpurifier/library/HTMLPurifier.auto.php'; // Include HTML Purifier        // Check if the required POST parameters are set    $requiredFields = [        'ld_client',        'zt_date',        'zt_title',        'zt_slug',        'zt_color',        'zt_tag',        'ta_excerpt'    ];        foreach ($requiredFields as $field) {        if (empty($_POST[$field])) {            retour_erreur(20, 7);        }    }        unset($_GET);        $client = $_POST['ld_client'];    $zt_color = $_POST['zt_color'];    $zt_date = $_POST['zt_date'];    $zt_title = nl2br(stripslashes($_POST['zt_title']));    $zt_slug = nl2br(stripslashes($_POST['zt_slug']));    $zt_tag = nl2br(stripslashes($_POST['$zt_tag']));        // Get the user-generated HTML content    $excerptHtml = $_POST['ta_excerpt'];    $textHtml = $_POST['ta_text'];    $goalHtml = $_POST['ta_goal'];        // Create an HTML Purifier configuration    $config = HTMLPurifier_Config::createDefault();    $purifier = new HTMLPurifier($config);        // Clean and sanitize the HTML content    $cleanExcerpt = $purifier->purify($excerptHtml);    $cleanText = $purifier->purify($textHtml);    $cleanGoal = $purifier->purify($goalHtml);        // Define the valid file extensions    $extensions_valides = array('jpg', 'jpeg', 'png');    $page = '20';    $error_code = '1024';        // Handle file upload    $dossier = "/assets/img/_portfolio/";    $destination = handleFileUpload($_FILES['f_thumb'], $dossier, $extensions_valides, $page, $error_code);    $stmt2 = $db->prepare('INSERT INTO projects (name, date, slug, client, color, slogan, excerpt, description, goal, img_thumb, created_at) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)');    $execute = $stmt2->execute([        $zt_title,        $zt_date,        $zt_slug,        $client,        $zt_color,        $zt_tag,        $cleanExcerpt,        $cleanText,        $cleanGoal,        $destination,        date('Y-m-d H:i:s')    ]);    if ($execute) {        $stmt2->closeCursor();        retour_erreur(20,201);    } else {        retour_erreur(20,202);    }?>