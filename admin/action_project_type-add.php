<?php    include("../_includes/session_test.inc");    include("../_includes/chabertdesign.inc");        if ($_SERVER['REQUEST_METHOD'] === 'POST') {        $element = $_POST['element'];                // Check if selected_types is an array        if (isset($_POST['selected_types']) && is_array($_POST['selected_types'])) {            $selectedTypes = $_POST['selected_types'];                        // Prepare the SQL statement outside the loop            $stmt2 = $db->prepare('INSERT INTO type_project (type, project) VALUES (?, ?)');                        // Start a database transaction for atomicity            $db->beginTransaction();                        // Check if records exist with the same project value            $stmtDelete = $db->prepare('DELETE FROM type_project WHERE project = ?');            $stmtDelete->execute([$element]);                        // Insert new records based on the selected types            foreach ($selectedTypes as $type) {                // Execute the SQL insert statement for each selected type                $execute = $stmt2->execute([$type, $element]);                                if (!$execute) {                    // Handle the error or print the error message for debugging                    print_r($stmt2->errorInfo());                    retour_erreur(21, 102);                }            }                        // Commit the transaction if everything is successful            $db->commit();                        // Close the prepared statements            $stmt2->closeCursor();            $stmtDelete->closeCursor();            retour_erreur(21, 101);        } else {            // Handle the case where no types are selected            retour_erreur(21, 103);        }    }?>