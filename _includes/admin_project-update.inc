<?php    $element = $_GET['project'];    unset($_POST);        $stmt = $db->prepare("select * from projects where id_project = ? ");    $stmt->execute([$element]);        while ($curseur1 = $stmt->fetch()) {        extract($curseur1);                $update = date('Y-m-d',strtotime($updated_at));                $client = $project_client;        $date = $project_date;        $color = $project_color;        $img = $img_thumb;                $title = nl2br(stripslashes($project_name));        $slug = $project_slug;        $headline = nl2br(stripslashes($project_slogan));                $excerpt = nl2br(stripslashes($project_excerpt));        $excerpt = str_replace("<br />", "", $excerpt);        $desc = nl2br(stripslashes($project_description));        $desc = str_replace("<br />", "", $desc);        $goal = nl2br(stripslashes($project_goal));        $goal = str_replace("<br />", "", $goal);            }?><div class="dashboard-main">    <div class="dashboard-title">Mettre à jour <?php echo $title ?></div>        <div class="dashboard-content">                <?php            if(!empty($update)){                echo "<h5 style='margin-bottom: 2rem'>Last update : $update</h5>";            }        ?>                <form method="post" id="project-form" data-element="<?php echo $element; ?>" enctype="multipart/form-data" style="margin-bottom: 3rem;">            <div class="d-form-wrapper">                <label>Select the type of project</label>                                <input name="element" type="hidden" value="<?php echo $element ?>">                                <div class="list-checklist">                    <?php                        // Retrieve the selected types for the specified project element                        $stmt2 = $db->prepare('SELECT type FROM type_project WHERE project = ?');                        $stmt2->execute([$element]);                        $selectedTypes = $stmt2->fetchAll(PDO::FETCH_COLUMN, 0); // Get an array of selected types                                                $sql1 = $db->prepare('SELECT * FROM types ORDER BY type_name ASC');                        $sql1->execute();                                                // Loop through the database records to create the checkboxes                        while ($row = $sql1->fetch(PDO::FETCH_ASSOC)) {                            $id_type = $row['id_type'];                            $type_name = $row['type_name'];                            $isChecked = in_array($id_type, $selectedTypes) ? 'checked' : '';                            echo '                <label class="custom-checkbox">                    <input type="checkbox" name="selected_types[]" value="' . $id_type . '" ' . $isChecked . '>                    ' . $type_name . '                </label>';                        }                    ?>                </div>            </div>            <div class="btn-primary btn-confirm small icon mobile-icon-only" id="update-types"><span>Save</span></div>        </form>                        <form method="post" action="action_project-update" enctype="multipart/form-data">            <div class="d-form-wrapper">                                <input name="element" type="hidden" value="<?php echo $element ?>">                                <div class="grid-layout-2">                    <div class="form-row column">                        <div class="select-dropdown">                            <label>Choisir le client</label>                            <select name="ld_client" required>                                <?php                                    echo "<option value=''>Choisir un client</option>";                                    $sql1 = $db->prepare('SELECT * FROM clients order by client_name ASC');                                    $sql1->execute();                                                                        while ($curseur1 = $sql1->fetch($result1)) {                                        extract($curseur1);                                        $name = nl2br(stripslashes($client_name));                                        if ($id_client == $client) {                                            $selected = "selected";                                        } else {                                            $selected = "";                                        }                                        echo "<option value=$id_client $selected>$name</option>";                                    }                                ?>                            </select>                        </div>                    </div>                </div>                <div class="grid-layout-3">                    <div class="form-row column">                        <label>Couleur</label>                        <input id="zt_color" name="zt_color" type="color" value="<?php echo $color ?>" style="height: 60px;" required>                    </div>                    <div class="form-row column">                        <label>Date du projet</label>                        <input id="zt_date" name="zt_date" type="date" value="<?php echo $date ?>" required>                    </div>                </div>                                <div class="grid-layout-2">                    <div class="form-row column">                        <label>Titre du projet (max : 80 caractères)</label>                        <input id="zt_title" name="zt_title" type="text" value="<?php echo $title ?>" maxlength="80" required>                    </div>                    <div class="form-row column">                        <label>URL du projet (max : 80 caractères)</label>                        <input id="zt_slug" name="zt_slug" type="text" value="<?php echo $slug ?>" maxlength="80" required>                    </div>                </div>                                <div class="form-row column">                    <label>Headline du projet (max : 256 caractères)</label>                    <input id="zt_headline" name="zt_headline" type="text" value="<?php echo $headline ?>" maxlength="256" required>                </div>                                <div class="form-row column">                    <label>Intro du projet</label>                    <textarea class="" id="ta_excerpt" name="ta_excerpt"><?php echo $excerpt ?></textarea>                </div>                                <!-- Include TinyMCE library -->                <script src="https://cdn.tiny.cloud/1/ww9qtqggrif3pyqjvuxyx5ee7lwdmh1857eqzsvb3o2f1d3f/tinymce/5/tinymce.min.js" referrerpolicy="origin"></script>                                <!-- Initialize TinyMCE on your textarea -->                <script>                    tinymce.init({                        selector: 'textarea.ta_text',                        width: '100%',                        min_height: 300,                        plugins: 'lists link table paste',                        toolbar: 'undo redo | styleselect | paste bold italic underline | bullist numlist | link table',                        paste_as_text: true,                        style_formats: [                            {                                title: 'Texte', items: [                                    {title: 'Titre de section', block: 'h2', classes: 'test'},                                    {title: 'Sous-titre', block: 'h3'},                                    {title: 'Intro', block: 'p', classes: 'case-study-excerpt'},                                    {title: 'Project description', block: 'p', classes: 'case-study-description'},                                    {title: 'Project Goal', block: 'h4', classes: 'case-study-goal'},                                    {title: 'Paragraphe', block: 'p'},                                    {title: 'Citation', format: 'blockquote'},                                    {title: 'Auteur', format: 'h6'}                                ]                            },                            {                                title: 'Align', items: [                                    {title: 'Left', format: 'alignleft'},                                    {title: 'Center', format: 'aligncenter'},                                    {title: 'Right', format: 'alignright'}                                ]                            }                        ],                        // The following option is used to append style formats rather than overwrite the default style formats.                        style_formats_merge: false,                        menubar: false                    });                </script>                                <div class="form-row column">                    <label>Texte du projet</label>                    <textarea class="ta_text" id="ta_text" name="ta_text"><?php echo $desc ?></textarea>                </div>                                <div class="form-row column">                    <label>Objectif du projet</label>                    <textarea class="ta_text" id="ta_goal" name="ta_goal"><?php echo $goal ?></textarea>                </div>                                                <div class="form-row column">                    <label>Thumb actuel</label>                    <?php                        echo "<div class='file-img-upload'><img src='$img' alt='$slug' /></div>";                    ?>                </div>                <ul class="file-list">                    <li class="file-list-element">                        <div class="dashboard-file-box">                            <input type="file" name="f_thumb" id="f_thumb" class="inputfile" required/>                            <label for="f_thumb" class="upload-file-btn"><span>Mettre à jour l'image</span></label>                        </div>                        <script src="/assets/js/custom-file-input.js"></script>                    </li>                </ul>                        </div>            <div class="d-form-cta">                <div class="btn-primary btn-revert small icon mobile-icon-only"><span>Effacer le contenu</span></div>                <div class="btn-primary btn-confirm small icon mobile-icon-only"><span>Mettre à jour</span></div>            </div>                </form>        </div>    </div><script>    $(document).ready(function () {        $("#update-types").on("click", function () {            // Serialize the form data            var formData = new FormData($("#project-form")[0]);            var element = $("#project-form").data("element"); // Get the project element            // Send the form data using AJAX            $.ajax({                type: "POST",                url: "action_project_type-add.php",                data: formData,                processData: false,                contentType: false,                success: function (response) {                    // Handle the response here                    if (response === "success") {                        // Update the page content or show a success message                    } else {                        // Handle errors or show an error message                    }                }            });            return false; // Prevent the default form submission        });    });</script>